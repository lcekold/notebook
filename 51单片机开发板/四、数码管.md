# 四、数码管
## 1.数码管简介
### （1）数码管电路
#### 1.1单个数码管
<div align="center"><img src="https://img1.imgtp.com/2023/08/02/yWnn5xxF.png"></div>
一个数码管是由a、b、c、d、e、f、g、dp八个二极管组成，八个LED一端接在一起，另一端引脚引出来。二极管如果阳极连在一起，就是共阳极数码管，阴极连在一起，就是共阴极数码管。

如上图，是一个共阴极数码管，要使数码管显示不同的数字，只需点亮对应LED即可。如：数码管显示“0”，则a、b、c、d、e、f六个LED亮，g、dp这俩个LED灭，即可显示“0”。

#### 1.2多个数码管
<div align="center" ><img src="https://img1.imgtp.com/2023/08/02/cvwPPHcr.png" height="200"></div>

上图所示的六个数码管，在使用时，需要程序选定使用哪几个数码管，这就是“位选”，选定数码管后再对选定的数码管进行操作，其操作与单个数码管的操作一致（接下来还会进一步详解），这就是“段选”。

### (2)数码管与芯片的连接
#### 2.1为什么要使用锁存器
二极管正常工作时需要5mA以上的电流，若数码管引脚和芯片引脚直接相连，芯片的I/O口无法输出这么大的电流，原因是芯片I/0口输出过大电流可能使温度升高从而对芯片造成损坏，对于共阴极的数码管，可以在阳极处接上拉电阻，对于共阳极的数码管，可以在阴极处接下拉电阻，但是也使得“位选”需做另外的处理。

引入锁存器，利用其输出电流大的特点，有效的解决了LED工作电流问题，而且还可以利用锁存器进行“位选”、“段选”。

#### 2.2锁存器的电路连接
<div align="center"><img src="https://img1.imgtp.com/2023/08/02/CWGzxgTR.png"></div>
上图所示，连接俩块锁存器，U1控制段选，U2控制位选
<div align="center"><img src="https://img1.imgtp.com/2023/08/02/7Ekzy4gy.png"></div>
根据电路图，OE始终接地，所以锁存器工作状态只有前三种，当LE软件置1时，锁存器的输入端D与输出端Q同高电平，同低电平，当LE软件置0时，锁存器输出为Q0。

由电路图可得，电路连接为：

单片机的芯片引脚P00—>P07分别接U1锁存器的D0——>D7,单片机的芯片引脚P00—>P07分别接U2锁存器的D0——>D7,也就是说U1、U2俩锁存器都与P0相连，所以在数码管工作状态下，俩个锁存器不能同时处于打开状态，即俩个锁存器的LE不能同时为高电平。锁存器U1的输出接数码管的LED阳极，锁存器U2的输出接数码管的WE，控制“数码管选择”。

锁存器U2控制位选，U2打开时，U1关闭，此时U2的输入和输出同高、同低电平。如下图，若使用数码管1，则只需D0置0，其他引脚置1，即芯片P00输出为0，P01——>P07输出为1，即P0寄存器的状态值为0xfe（上面低位，从下往上读）

<div align="center"><img src="https://img1.imgtp.com/2023/08/02/8kfSD8GI.png"></div>

锁存器U1控制段选，如刚刚位选了数码管1，则接下来段选是对数码管1的操作。此时关闭U2，打开U1，即U2的LE软件置0，U1的LE软件置1，而U2的LE与芯片的P27相连，U1的LE与芯片的P26相连（下图所示），所以只需使芯片的P27输出低电平来关闭U2锁存器，P26输出高电平来打开U1锁存器。

<div align="center"><img src="https://img1.imgtp.com/2023/08/02/bnylXnC9.png"></div>

打开U1锁存器后，使数码管显示某个数字，我们在第一节中总结过了，比如显示一个数字“6”，需要a、c、d、e、f、g六个LED亮，所以锁存器输出01111101（共阴极数码管。输出1时点亮），即P0寄存器输出01111101，P0寄存器的状态值为0x7d。

<div align="center"><img src="https://img1.imgtp.com/2023/08/02/Utwx2vNE.png"></div>
<div align="center"><img src="https://img1.imgtp.com/2023/08/02/ArNctA1Q.png"></div>

## 2.代码练习
接下来再写代码的过程中，请反复看这张图，了解其中的原理
<div align="center"><img src="https://img1.imgtp.com/2023/08/02/H3IjuOno.png"></div>

### （1）静态数码管显示
#### 1.1 数码管的某一位显示一个数字
```c
#include <REGX52.H>
int main()
{
	P2_4=1;
	P2_3=0;
	P2_2=1;
	P0=0x7D;
	while(1)
	{
		
	}
}
```
以上代码让数码管的第三位显示为6

	那么如果我们要第④位显示数字⑥的话该怎么办？很简单把P2_4=1；P2_3=0；P2_2=0；

	LED会亮的原因是因为引脚冲突这个不需要去管它。

<div align="center"><img src="https://img1.imgtp.com/2023/08/02/HNMe8ZSW.png"></div>

